project_root="$(dirname "${BASH_SOURCE[0]:-${(%):-%x}}")"

venv="$project_root/venv"

req_dir="$project_root/requirements"

app_dir="$project_root/bird_identification_web"

if [ -n "$PYTHONPATH" ]; then
    export PYTHONPATH=$project_root/bird_identification_web:$PYTHONPATH
else
    export PYTHONPATH=$project_root/bird_identification_web
fi

export DJANGO_SETTINGS_MODULE=bird_identification_web.settings

function load_vars() {
    local source_path="$project_root/$1"

    test -f "$source_path" && source "$source_path"
}

load_vars "vars.local"

if [[ -n "$SETUP_MODE" ]]; then
    load_vars "vars.$SETUP_MODE"
    load_vars "vars.$SETUP_MODE.local"
fi

if [[ -n "$SETUP_PLATFORM" ]]; then
    load_vars "vars.$SETUP_PLATFORM"
    load_vars "vars.$SETUP_PLATFORM.local"
fi

if [[ -n "$SETUP_MODE" ]] && [[ -n "$SETUP_PLATFORM" ]]; then
    load_vars "vars.$SETUP_MODE.$SETUP_PLATFORM"
    load_vars "vars.$SETUP_MODE.$SETUP_PLATFORM.local"
fi
